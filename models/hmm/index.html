
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python-based Feature Screening library">
      
      
      
        <link rel="canonical" href="https://narrowgateai.github.io/models/hmm/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>HMM_nb - narrowgate</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#narrowgate.model.hidden_markov_model.HMM_nb" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="narrowgate" class="md-header__button md-logo" aria-label="narrowgate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 21V7H5v4H3V9H1v12h2v-2h2v2h2m-4-4v-4h2v4H3m18-8v2h-2V7h-2v14h2v-2h2v2h2V9h-2m0 8h-2v-4h2v4z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            narrowgate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HMM_nb
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/narrowgateai/narrowgate/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    narrowgateai/narrowgate
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="narrowgate" class="md-nav__button md-logo" aria-label="narrowgate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 21V7H5v4H3V9H1v12h2v-2h2v2h2m-4-4v-4h2v4H3m18-8v2h-2V7h-2v14h2v-2h2v2h2V9h-2m0 8h-2v-4h2v4z"/></svg>

    </a>
    narrowgate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/narrowgateai/narrowgate/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    narrowgateai/narrowgate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Screeners
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Screeners" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Screeners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Univariate
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Univariate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Univariate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/univariate/" class="md-nav__link">
        UnivariateScreener
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/univariate_screener/" class="md-nav__link">
        Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Bivariate
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bivariate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Bivariate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/bivariate/" class="md-nav__link">
        BivariateScreener
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          FSCA
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="FSCA" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          FSCA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/fsca/" class="md-nav__link">
        FSCA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/fsca_selector/" class="md-nav__link">
        FSCASelector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/fsca_transformer/" class="md-nav__link">
        FSCATransformer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Hidden Markov Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hidden Markov Model" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Hidden Markov Model
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/hmm_target/" class="md-nav__link">
        HMMTargetLinkScreener
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/hmm_memory/" class="md-nav__link">
        HMMMemoryScreener
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          Stepwise
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Stepwise" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Stepwise
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/stepwise/" class="md-nav__link">
        EnhancedStepwiseScreener
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../screeners/stepwise_selector/" class="md-nav__link">
        EnhancedStepwiseSelector
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Encoders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Encoders" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Encoders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Nominal2Ordinal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Nominal2Ordinal" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Nominal2Ordinal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../encoders/nom_ord/" class="md-nav__link">
        Nominal2OrdinalEncoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/nominal2ordinal/" class="md-nav__link">
        Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          LinearRegression (Numba)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LinearRegression (Numba)" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          LinearRegression (Numba)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear_regression/" class="md-nav__link">
        LinearRegression_nb
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Hidden Markov Model (Numba)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hidden Markov Model (Numba)" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Hidden Markov Model (Numba)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          HMM_nb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        HMM_nb
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb" class="md-nav__link">
    HMM_nb
  </a>
  
    <nav class="md-nav" aria-label="HMM_nb">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb--references" class="md-nav__link">
    References
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.backward" class="md-nav__link">
    backward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.initialize" class="md-nav__link">
    initialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_mean_covar" class="md-nav__link">
    find_mean_covar()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_densities" class="md-nav__link">
    find_densities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.update_mean_covar" class="md-nav__link">
    update_mean_covar()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Model Selection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Selection" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Model Selection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Walk-Backward Time Series CV
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Walk-Backward Time Series CV" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Walk-Backward Time Series CV
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../model_selection/walk_backward/" class="md-nav__link">
        WalkBackwardTimeSeriesCV
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Combinatorially Purged CV
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Combinatorially Purged CV" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Combinatorially Purged CV
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../model_selection/cpcv/" class="md-nav__link">
        CombinatorialPurgedCrossValidation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_1" type="checkbox" id="__nav_6_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_1">
          Metrics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Metrics" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/metrics_cpu/" class="md-nav__link">
        CPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/metrics_gpu/" class="md-nav__link">
        GPU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Partitioning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Partitioning" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Partitioning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/partition_cpu/" class="md-nav__link">
        CPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/partition_gpu/" class="md-nav__link">
        GPU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Sorting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sorting" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Sorting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/sort_cpu/" class="md-nav__link">
        CPU
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/sort_gpu/" class="md-nav__link">
        GPU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/stats/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/validation/" class="md-nav__link">
        Validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/test/" class="md-nav__link">
        Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/cluster/" class="md-nav__link">
        Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/pca/" class="md-nav__link">
        PCA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/numba/" class="md-nav__link">
        Numba
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb" class="md-nav__link">
    HMM_nb
  </a>
  
    <nav class="md-nav" aria-label="HMM_nb">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb--references" class="md-nav__link">
    References
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.backward" class="md-nav__link">
    backward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.initialize" class="md-nav__link">
    initialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_mean_covar" class="md-nav__link">
    find_mean_covar()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_densities" class="md-nav__link">
    find_densities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#narrowgate.model.hidden_markov_model.HMM_nb.update_mean_covar" class="md-nav__link">
    update_mean_covar()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/narrowgateai/narrowgate/edit/master/docs/models/hmm.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



  <h1>HMM_nb</h1>

<div class="doc doc-object doc-class">



<h2 id="narrowgate.model.hidden_markov_model.HMM_nb" class="doc doc-heading">
          <code>HMM_nb</code>



<a href="#narrowgate.model.hidden_markov_model.HMM_nb" class="headerlink" title="Permanent link">¤</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">HMM_nb</span><span class="p">(</span><span class="n">n_init</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


      <p>Hidden Markov Model class.</p>
<p>A hidden Markov model produces state probabilities where being in a given
state at an observed time depends on the process's state at the prior 
observed time. This dependency is referred to as the 'memory' inherent in
the model.</p>
<p>Implemented using numba's <code>@jitclass</code> operator.</p>
<p>Ideal for use inside numba parallelization loops (<code>prange</code>).</p>
<p>A 'fit' model (via the <code>fit()</code> method) will produce the <code>Attributes</code> below <br />
The <code>state_probs</code> values are used as additional features in a predictive 
model within the 
<a class="autorefs autorefs-internal" href="../../screeners/hmm_target/#narrowgate.screeners.HMMTargetLinkScreener">HMMTargetLinkScreener</a> class.<br />
The <code>transition</code> matrix provides the probability of transitioning from 
one state to another.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>means</code></td>
          <td>
                <code>np.ndarray</code>
          </td>
          <td><p>matrix of means for each state<br />
shape: (nstates, nvars)</p></td>
        </tr>
        <tr>
          <td><code>covars</code></td>
          <td>
                <code>np.ndarray</code>
          </td>
          <td><p>set of covariance matrices, one for each state<br />
shape: (nstates, nvars, nvars)</p></td>
        </tr>
        <tr>
          <td><code>transition</code></td>
          <td>
                <code>np.ndarray</code>
          </td>
          <td><p>matrix of transition probabilities<br />
shape: (nstates, nstates)</p></td>
        </tr>
        <tr>
          <td><code>state_probs</code></td>
          <td>
                <code>np.ndarray </code>
          </td>
          <td><p>matrix of state membership probabilities for each case<br />
shape: (ncases, nstates)</p></td>
        </tr>
        <tr>
          <td><code>init_probs</code></td>
          <td>
                <code>np.array </code>
          </td>
          <td><p>vector of state probabilities of first case<br />
shape: (nstates,)</p></td>
        </tr>
    </tbody>
  </table>
      <h4 id="narrowgate.model.hidden_markov_model.HMM_nb--references">References<a class="headerlink" href="#narrowgate.model.hidden_markov_model.HMM_nb--references" title="Permanent link">¤</a></h4>
<p>Masters, Timothy. (2019) "Extracting and Selecting Features for Data 
Mining: Algorithms in C++ and CUDA". pp. 119-158.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_init</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of initial trial parameter sets to test for finding a
good stating point for iteration.  Larger values make it more likely
that the iterations, which always converge to a local optimum,
will find the global optimum. (a minimum of 1000 is recommended
by Masters with a value of 10,000 not being unreasonable).</p></td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>max_iter</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Iteration limit for convergence.
This is insurance only, and should always be set very large to
ensure complete convergence. Normally, convergence will be obtained
long before this is hit.</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
              <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n_init</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n_init : int</span>
<span class="sd">        Number of initial trial parameter sets to test for finding a</span>
<span class="sd">        good stating point for iteration.  Larger values make it more likely</span>
<span class="sd">        that the iterations, which always converge to a local optimum,</span>
<span class="sd">        will find the global optimum. (a minimum of 1000 is recommended</span>
<span class="sd">        by Masters with a value of 10,000 not being unreasonable).</span>
<span class="sd">    max_iter : int</span>
<span class="sd">        Iteration limit for convergence.</span>
<span class="sd">        This is insurance only, and should always be set very large to</span>
<span class="sd">        ensure complete convergence. Normally, convergence will be obtained</span>
<span class="sd">        long before this is hit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_init</span> <span class="o">=</span> <span class="n">n_init</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>
</code></pre></div>
</td></tr></table>
            </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.fit" class="doc doc-heading">
fit


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.fit" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">nstates</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Method for estimating the parameters of a Hidden Markov Model utilizing
the Baum-Welch Algorithm.</p>
<p><strong>Important note</strong><br />
The number of time series features (columns) in dataset <code>X</code> (referred
to inside the method as <code>nvars</code>) should ideally be between 2 and 5. 
Using 5 to 10 features should be considered extremely dangerous due to 
substantially increased runtime and memory usage.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X</code></td>
          <td>
                <code>np.ndarray</code>
          </td>
          <td><p>Numpy matrix (ncases, nvars)<br />
It is ideal that the each column/feature be at least moderately 
standardized (mean zero, unit variance), although this is not 
required. If the data contains any features (time series) which 
are nearly collinear (highly correlated) with one another, the 
modeling process will encounter significant trouble. However, some 
correlation amongst the columns is fine.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_states</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of hidden states for the model to posit.<br />
More than 3 to 4 states can produce highly unstable results</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_iter</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of iterations to perform for finding the maximum 
likelihood parameters of the model. If the model converges prior 
to this number, early stopping will occur. If the method completes
and the return value of <code>n_iter</code> is <code>max_iter-1</code>, then complete
convergence was not obtained.</p></td>
          <td>
                <code>100</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>n_iter</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>The number of iterations performed before complete convergence of
the algorithm was obtained. If the value returned is <code>max_iter-1</code>,
then complete convergence was not obtained.</p></td>
        </tr>
        <tr>
<td><code>likelihood</code></td>          <td>
                <code>float</code>
          </td>
          <td><p>The log likelihood of the observations in <code>X</code> coming from the best 
performing set of model parameters found across the performed 
iterations.</p></td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">X</span><span class="p">,</span> 
    <span class="n">nstates</span><span class="p">,</span> 
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method for estimating the parameters of a Hidden Markov Model utilizing</span>
<span class="sd">    the Baum-Welch Algorithm.</span>

<span class="sd">    **Important note**  </span>
<span class="sd">    The number of time series features (columns) in dataset `X` (referred</span>
<span class="sd">    to inside the method as `nvars`) should ideally be between 2 and 5. </span>
<span class="sd">    Using 5 to 10 features should be considered extremely dangerous due to </span>
<span class="sd">    substantially increased runtime and memory usage.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : np.ndarray</span>
<span class="sd">        Numpy matrix (ncases, nvars)  </span>
<span class="sd">        It is ideal that the each column/feature be at least moderately </span>
<span class="sd">        standardized (mean zero, unit variance), although this is not </span>
<span class="sd">        required. If the data contains any features (time series) which </span>
<span class="sd">        are nearly collinear (highly correlated) with one another, the </span>
<span class="sd">        modeling process will encounter significant trouble. However, some </span>
<span class="sd">        correlation amongst the columns is fine.</span>
<span class="sd">    n_states : int</span>
<span class="sd">        The number of hidden states for the model to posit.  </span>
<span class="sd">        More than 3 to 4 states can produce highly unstable results</span>
<span class="sd">    max_iter : int</span>
<span class="sd">        The number of iterations to perform for finding the maximum </span>
<span class="sd">        likelihood parameters of the model. If the model converges prior </span>
<span class="sd">        to this number, early stopping will occur. If the method completes</span>
<span class="sd">        and the return value of `n_iter` is `max_iter-1`, then complete</span>
<span class="sd">        convergence was not obtained.    </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_iter : int</span>
<span class="sd">        The number of iterations performed before complete convergence of</span>
<span class="sd">        the algorithm was obtained. If the value returned is `max_iter-1`,</span>
<span class="sd">        then complete convergence was not obtained.</span>

<span class="sd">    likelihood : float</span>
<span class="sd">        The log likelihood of the observations in `X` coming from the best </span>
<span class="sd">        performing set of model parameters found across the performed </span>
<span class="sd">        iterations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">max_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&#39;max_iter&#39; must be greater than 0!&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">X</span>

    <span class="n">ncases</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Initialize members to be used throughout methods</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nvars</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nvars</span><span class="p">,</span> <span class="n">nvars</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">ncases</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ncases</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ncases</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nstates</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ncases</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>

    <span class="c1">################</span>
    <span class="c1">## Initialize ##</span>
    <span class="c1">################</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">find_mean_covar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nstates</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nstates</span><span class="p">)</span>

    <span class="c1"># Initialize some other objects needed for this method</span>
    <span class="n">trans_work1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="n">trans_work2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">max_prod</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># Main outermost loop is here</span>
    <span class="n">prior_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.e200</span>

    <span class="c1"># create floor array</span>
    <span class="n">floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nstates</span><span class="p">)</span>
    <span class="n">floor</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">1.e-100</span>

    <span class="k">for</span> <span class="n">n_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">):</span>

        <span class="c1"># Compute alpha, beta, and log likelihood.</span>
        <span class="c1"># While backward_prob is not explicitly needed, it can serve as a </span>
        <span class="c1"># nice diagnostic.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_densities</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">)</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">)</span>
        <span class="n">backward_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

        <span class="c1">#if (print  ||  file_print)</span>
        <span class="c1">#   print_params ( print , file_print , iter , likelihood , backward_prob ) ;</span>

        <span class="c1">#####################################################</span>
        <span class="c1">## Compute probability of each state for each case ##</span>
        <span class="c1">#####################################################</span>
        <span class="c1"># Update means and covariances</span>
        <span class="k">for</span> <span class="n">icase</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">):</span>
            <span class="c1"># Step 1 of 3: Find maximum of (alpha * beta)</span>
            <span class="n">alpha_beta_prod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">icase</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">icase</span><span class="p">]</span>
            <span class="c1"># test against floor</span>
            <span class="n">alpha_beta_prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">alpha_beta_prod</span><span class="p">,</span> <span class="n">floor</span><span class="p">)</span>
            <span class="n">max_prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">alpha_beta_prod</span><span class="p">)</span>
            <span class="n">sum_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">alpha_beta_prod</span> <span class="o">/</span> <span class="n">max_prod</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_probs</span><span class="p">[</span><span class="n">icase</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">alpha_beta_prod</span> <span class="o">/</span> <span class="n">max_prod</span> <span class="o">/</span> <span class="n">sum_</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_mean_covar</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Update initial state probabilities and transition matrix</span>
        <span class="c1"># set &#39;init_probs&#39; and zero out the trans_work2 matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_probs</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
        <span class="n">trans_work2</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">icase</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncases</span><span class="p">):</span>
            <span class="c1"># Find max product for scaling;</span>
            <span class="c1"># save each product to avoid recomputing</span>
            <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">jstate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[(</span><span class="n">icase</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">istate</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">300.0</span><span class="p">):</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[(</span><span class="n">icase</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">istate</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">300.0</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">300.0</span><span class="p">):</span>
                        <span class="n">temp</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">-=</span> <span class="mf">300.0</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">jstate</span><span class="p">,</span> <span class="n">icase</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">300.0</span><span class="p">):</span>
                        <span class="n">temp</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">jstate</span><span class="p">,</span> <span class="n">icase</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">-=</span> <span class="mf">300.0</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">icase</span><span class="p">,</span> <span class="n">istate</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">300.0</span><span class="p">):</span>
                        <span class="n">temp</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">icase</span><span class="p">,</span> <span class="n">jstate</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">-=</span> <span class="mf">300.0</span>

                    <span class="n">trans_work1</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">istate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">jstate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">max_prod</span> <span class="o">=</span> <span class="n">temp</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">max_prod</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">max_prod</span><span class="p">)</span>

            <span class="c1"># Sum the exp() of the shifted terms</span>
            <span class="n">trans_work1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">trans_work1</span> <span class="o">-</span> <span class="n">max_prod</span><span class="p">)</span>
            <span class="n">sum_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">trans_work1</span><span class="p">)</span>

            <span class="c1"># Normalize to probabilities</span>
            <span class="n">trans_work2</span> <span class="o">+=</span> <span class="n">trans_work1</span> <span class="o">/</span> <span class="n">sum_</span>

        <span class="c1">#######################</span>
        <span class="c1">## End for all cases ##</span>
        <span class="c1">#######################</span>

        <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
            <span class="n">sum_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">trans_work2</span><span class="p">[</span><span class="n">istate</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans_work2</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span> <span class="o">/</span> <span class="n">sum_</span>

        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n_iter</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">likelihood</span><span class="o">-</span><span class="n">prior_likelihood</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-8</span><span class="p">):</span>
            <span class="k">break</span>

        <span class="n">prior_likelihood</span> <span class="o">=</span> <span class="n">likelihood</span>

    <span class="c1">#######################</span>
    <span class="c1">## End of iterations ##</span>
    <span class="c1">#######################</span>

    <span class="k">return</span> <span class="n">n_iter</span><span class="p">,</span> <span class="n">likelihood</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.forward" class="doc doc-heading">
forward


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.forward" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">forward</span><span class="p">(</span><span class="n">these_transitions</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Forward pass of Baum-Welch algorithm for finding maximum-likelihood 
parameters of a Hidden Markov Model.</p>
<p>This is Master's enhanced version that use logarithmic values for 
increased numerical stability.</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">these_transitions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forward pass of Baum-Welch algorithm for finding maximum-likelihood </span>
<span class="sd">    parameters of a Hidden Markov Model.</span>

<span class="sd">    This is Master&#39;s enhanced version that use logarithmic values for </span>
<span class="sd">    increased numerical stability.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Instance members</span>
    <span class="c1"># init_probs -&gt; (nstates,)</span>
    <span class="c1"># alpha -&gt; (ncases, nstates)</span>
    <span class="c1"># beta -&gt; (ncases, nstates)</span>
    <span class="c1"># densities -&gt; (nstates, ncases)</span>

    <span class="c1"># Parameters</span>
    <span class="c1"># these_transitions -&gt; (nstates, nstates)</span>

    <span class="n">ncases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nstates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Initialize first case (t=0):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_probs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">denom</span>

    <span class="c1"># Recursion for remaining cases:</span>
    <span class="c1"># alpha[t,i] = Sum over j of (alpha[t-1,j]*transitions[j,i]) * densities[i,t]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncases</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
            <span class="n">sum_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">these_transitions</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">t</span><span class="p">]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">log_likelihood</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/=</span> <span class="n">denom</span>

    <span class="k">return</span> <span class="n">log_likelihood</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.backward" class="doc doc-heading">
backward


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.backward" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">backward</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Backward pass of Baum-Welch algorithm for finding maximum-likelihood 
parameters of a Hidden Markov Model.</p>
<p>This is Master's enhanced version that use logarithmic values for 
increased numerical stability.</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backward pass of Baum-Welch algorithm for finding maximum-likelihood </span>
<span class="sd">    parameters of a Hidden Markov Model.</span>

<span class="sd">    This is Master&#39;s enhanced version that use logarithmic values for </span>
<span class="sd">    increased numerical stability.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># init_probs -&gt; (nstates,)</span>
    <span class="c1"># beta -&gt; (ncases, nstates)</span>
    <span class="c1"># densities -&gt; (nstates, ncases)</span>
    <span class="c1"># these_transitions -&gt; (nstates, nstates)</span>

    <span class="n">ncases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nstates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Initialize for last case (t=ncases-1):</span>
    <span class="c1"># beta[ncases-1,i] = 1.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">ncases</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">nstates</span>
    <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nstates</span><span class="p">)</span>

    <span class="c1"># Recursion for remaining cases:</span>
    <span class="c1"># beta[t,i] = \</span>
    <span class="c1">#     Sum over j of (transition[i,j] * densities[j,t+1] * beta[t+1,j])</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
            <span class="n">sum_</span> <span class="o">=</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">*</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_</span>
            <span class="n">denom</span> <span class="o">+=</span> <span class="n">sum_</span>
        <span class="n">log_likelihood</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/=</span> <span class="n">denom</span>

    <span class="c1"># Termination:</span>
    <span class="c1"># Final probability = \</span>
    <span class="c1">#     Sum over i of init_probs[i] * densities[i,0] * beta[0,i]</span>
    <span class="n">sum_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_probs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Include the termination likelihood</span>
    <span class="n">log_likelihood_terminal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sum_</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_likelihood</span>

    <span class="k">return</span> <span class="n">log_likelihood_terminal</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.initialize" class="doc doc-heading">
initialize


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.initialize" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">initialize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">nstates</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Initialize starting parameters of a Hidden Markov Model.  </p>
<p>Tries some random values of means and transition probabilities to find 
the best likelihood in the parameter search space compared to other 
points in the space.</p>
<p>Results from this method will serve as the starting point for 
iterations performed in the <code>fit()</code> method.</p>
<p>Called after <code>find_mean_covar()</code> method.</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nstates</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize starting parameters of a Hidden Markov Model.  </span>

<span class="sd">    Tries some random values of means and transition probabilities to find </span>
<span class="sd">    the best likelihood in the parameter search space compared to other </span>
<span class="sd">    points in the space.</span>

<span class="sd">    Results from this method will serve as the starting point for </span>
<span class="sd">    iterations performed in the `fit()` method.</span>

<span class="sd">    Called after `find_mean_covar()` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ncases</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># create working arrays and matrices</span>
    <span class="n">trial_transition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nstates</span><span class="p">))</span>
    <span class="n">trial_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nstates</span><span class="p">,</span> <span class="n">nvars</span><span class="p">))</span>
    <span class="n">init_covar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># initialize probabilities</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_probs</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">nstates</span>

    <span class="c1"># Start main loop ... trying many combinations</span>
    <span class="c1"># For the first half of trials, assign equal transition probs</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">nstates</span>
    <span class="n">trial_transition</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">prob</span>

    <span class="n">best_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.e200</span>

    <span class="k">for</span> <span class="n">itrial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_init</span><span class="p">):</span>

        <span class="c1"># Perturb the means.  Make sure the offsets sum to zero.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
            <span class="n">sum_</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">istate</span> <span class="o">&lt;</span> <span class="n">nstates</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">unif_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span>
                    <span class="n">wt</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">unif_rand</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                    <span class="n">sum_</span> <span class="o">+=</span> <span class="n">wt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">wt</span> <span class="o">=</span> <span class="o">-</span><span class="n">sum_</span>
                <span class="n">trial_means</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">wt</span>

        <span class="c1"># Perturb the covariances by shrinking</span>
        <span class="c1"># Shrinkage for diagonal</span>
        <span class="n">wtd</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="c1"># Shrinkage for off-diagonal</span>
        <span class="n">wto</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">wtd</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">):</span>
                    <span class="n">dtemp</span> <span class="o">=</span> <span class="n">wtd</span> <span class="o">*</span> <span class="n">init_covar</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dtemp</span> <span class="o">=</span> <span class="n">wto</span> <span class="o">*</span> <span class="n">init_covar</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="p">;</span>
                <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dtemp</span>

        <span class="c1"># Perturb the transition probabilities starting at half of the trials</span>
        <span class="k">if</span> <span class="n">itrial</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_init</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                <span class="n">unif_rand</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span>
                <span class="n">prob</span> <span class="o">=</span> <span class="n">unif_rand</span>
                <span class="n">trial_transition</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">istate</span><span class="p">]</span> <span class="o">=</span>  <span class="n">unif_rand</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">==</span> <span class="n">istate</span><span class="p">:</span>
                        <span class="n">trial_transition</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">prob</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nstates</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1">#HMM::find_densities(double *these_means)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_densities</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">trial_means</span><span class="p">)</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">trial_transition</span><span class="p">)</span>

        <span class="c1"># Print trial if requested</span>
        <span class="c1">#fprintf ( fp , &quot;\n\n\nInitialization trial %d of %d&quot;, itrial+1, n_trials ) ;</span>
        <span class="c1">#sprintf ( msg , &quot;State %d  Means =&quot;, istate ) ;</span>
        <span class="c1">#sprintf ( msg2 , &quot; %10.2lf&quot;, trial_means[istate*nvars+i] ) ;</span>

        <span class="c1">#fprintf ( fp , &quot;\n\nCommon covariances...&quot; ) ;</span>

        <span class="c1">#fprintf ( fp, &quot;\n\nTransition probability matrix...&quot; ) ;</span>
        <span class="c1">#sprintf ( msg2 , &quot; %7.3lf&quot;, trial_transition[i*nstates+j] ) ;</span>

        <span class="c1"># update best</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">itrial</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">likelihood</span> <span class="o">&gt;</span> <span class="n">best_likelihood</span><span class="p">):</span>
            <span class="n">best_likelihood</span> <span class="o">=</span> <span class="n">likelihood</span>
            <span class="c1">#for (i=0 ; i&lt;nstates*nvars ; i++)</span>
            <span class="c1">#    best_means[i] = trial_means[i] ;</span>
            <span class="n">best_means</span> <span class="o">=</span> <span class="n">trial_means</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1">#for (i=0 ; i&lt;nvars*nvars ; i++)</span>
            <span class="c1">#    best_covar[i] = covars[i] ;</span>
            <span class="n">best_covar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1">#for (i=0 ; i&lt;nstates*nstates ; i++)</span>
            <span class="c1">#      best_transition[i] = trial_transition[i] ;</span>
            <span class="n">best_transition</span> <span class="o">=</span> <span class="n">trial_transition</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># The best are found.  Copy them to the private versions.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">best_means</span><span class="p">[:,:]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">best_transition</span><span class="p">[:,:]</span>
    <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_covar</span><span class="p">[:,:]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.find_mean_covar" class="doc doc-heading">
find_mean_covar


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_mean_covar" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">find_mean_covar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nstates</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Compute means and covariances of features/columns.</p>
<p>Called once before calling <code>initialize()</code> method.</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_mean_covar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">nstates</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute means and covariances of features/columns.</span>

<span class="sd">    Called once before calling `initialize()` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">data_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nvars</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
        <span class="n">data_means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
    <span class="n">data_covar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_means</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_covar</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.find_densities" class="doc doc-heading">
find_densities


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.find_densities" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">find_densities</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">these_means</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Compute densities of features/columns</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_densities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">these_means</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute densities of features/columns</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nstates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncases</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">mv_normal_pdf_nb</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">these_means</span><span class="p">[</span><span class="n">istate</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="narrowgate.model.hidden_markov_model.HMM_nb.update_mean_covar" class="doc doc-heading">
update_mean_covar


<a href="#narrowgate.model.hidden_markov_model.HMM_nb.update_mean_covar" class="headerlink" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">update_mean_covar</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

      <p>Update means and covariances of features/columns.</p>

        <details class="quote">
          <summary>Source code in <code>narrowgate/model/hidden_markov_model.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_mean_covar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update means and covariances of features/columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># X -&gt;</span>
    <span class="c1"># means -&gt; (nstates, nvars)</span>
    <span class="c1"># covars -&gt; (nstates, nvars, nvars)</span>
    <span class="c1"># state_probs -&gt; (ncases, nstates)</span>

    <span class="n">ncases</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nstates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">istate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstates</span><span class="p">):</span>
        <span class="c1"># &#39;Reset&#39; covars matrix for the given state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="c1"># Prevent zero variance</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">],</span> <span class="mf">1.e-20</span><span class="p">)</span>

        <span class="c1"># retrieve the state probabilities to serve as weights</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_probs</span><span class="p">[:,</span><span class="n">istate</span><span class="p">]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

        <span class="c1"># Calculate the means for each variable according to the</span>
        <span class="c1"># state probabilities which serve as weights</span>
        <span class="c1"># The following line of code applies the vector of probabilities</span>
        <span class="c1"># for the given state (istate) to each variable/column in data.</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tmp</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">denom</span> <span class="o">+</span> <span class="mf">1.e-100</span><span class="p">)</span>

        <span class="c1"># calculate the covariance matrix</span>
        <span class="c1"># since weights need to be applied and numba does not support</span>
        <span class="c1"># weights in the &#39;nopython&#39; mode, need to do this the same way</span>
        <span class="c1"># Masters does in C.</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># subtract the means for each variable for istate across all</span>
        <span class="c1"># observation in data (via broadcast)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">icase</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">):</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">icase</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> \
                        <span class="n">weight</span> <span class="o">*</span> <span class="n">tmp</span><span class="p">[</span><span class="n">icase</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">tmp</span><span class="p">[</span><span class="n">icase</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">]</span> <span class="o">/=</span> <span class="p">(</span><span class="n">denom</span> <span class="o">+</span> <span class="mf">1.e-100</span><span class="p">)</span>

        <span class="c1"># ensure that matrix is invertible</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
                <span class="n">const1</span> <span class="o">=</span> \
                    <span class="p">(</span><span class="mf">0.999999</span> <span class="o">*</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">const2</span> <span class="o">=</span> \
                    <span class="p">(</span><span class="o">-</span><span class="mf">0.999999</span> <span class="o">*</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">cond0</span> <span class="o">=</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span>
                <span class="n">cond1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">const1</span>
                <span class="n">cond2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">const2</span>
                <span class="k">if</span> <span class="n">cond0</span> <span class="ow">and</span> <span class="n">cond1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">const1</span>
                <span class="k">if</span> <span class="n">cond0</span> <span class="ow">and</span> <span class="n">cond2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">covars</span><span class="p">[</span><span class="n">istate</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">const2</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../linear_regression/" class="md-footer__link md-footer__link--prev" aria-label="Previous: LinearRegression_nb" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              LinearRegression_nb
            </div>
          </div>
        </a>
      
      
        
        <a href="../../model_selection/walk_backward/" class="md-footer__link md-footer__link--next" aria-label="Next: WalkBackwardTimeSeriesCV" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              WalkBackwardTimeSeriesCV
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>